pipeline{
 agent any
    environment{
      pom_groupid=readMavenPom().getGroupId()
      pom_artifactid=readMavenPom().getArtifactId()
      pom_version=readMavenPom().getVersion()
    }
   stages{ 
     stage('build'){
       steps{
       echo "the groupid is ${pom_groupid}"
       echo "the groupid is ${pom_artifactid}"
       echo "the groupid is ${pom_version}"
       sh label: '', script: 'mvn clean install package deploy'
       }
     }
     stage("upload war"){
      steps{
      nexusArtifactUploader artifacts: [[artifactId: 'studentapp', classifier: '', file: 'target/studentapp-echo "${pom_version}".war', type: 'war']], credentialsId: 'nexus', groupId: 'com.jdevs', nexusUrl: '3.21.244.117:8081', nexusVersion: 'nexus3', protocol: 'http', repository: 'lenovo', version: '${pom_version}'
    }
  }
 }
}
