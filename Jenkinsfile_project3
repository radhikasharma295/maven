pipeline{
 agent any
    environment{
      pom_groupid=readMavenPom().getGroupId()
      pom_artifactid=readMavenPom().getArtifactId()
      pom_version=readMavenPom().getVersion()
    }
   stages{ 
     stage('build'){
       steps{
       echo "the groupid is ${pom_groupid}"
       echo "the groupid is ${pom_artifactid}"
       echo "the groupid is ${pom_version}"
       sh label: '', script: 'mvn clean install package deploy'
       }
     }
     stage("upload war"){
      steps{
      nexusArtifactUploader artifacts: [[artifactId: '${pom_artifactid}', classifier: '', file: 'target/studentapp-2.0.war', type: 'war']], credentialsId: 'nexus', groupId: '${pom_groupid}', nexusUrl: '3.21.244.117:8081', nexusVersion: 'nexus3', protocol: 'http', repository: 'lenovo', version: '${pom_version}'
   }
}
}
}
